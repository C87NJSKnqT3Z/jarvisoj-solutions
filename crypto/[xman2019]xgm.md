## 描述

n1=21660190931013270559487983141966347279666044468572000325628282578595119101840917794617733535995976710097702806131277006786522442555607842485975616689297559583352413160087163656851019769465637856967511819803473940154712516380580146620018921406354668604523723340895843009899397618067679200188650754096242296166060735958270930743173912010852467114047301529983496669250671342730804149428700280401481421735184899965468191802844285699985370238528163505674350380528600143880619512293622576854525700785474101747293316814980311297382429844950643977825771268757304088259531258222093667847468898823367251824316888563269155865061  
e1=65537  
c1=11623242520063564721509699039034210329314238234068836130756457335142671659158578379060500554276831657322012285562047706736377103534543565179660863796496071187533860896148153856845638989384429658963134915230898572173720454271369543435708994457280819363318783413033774014447450648051500214508699056865320506104733203716242071136228269326451412159760818676814129428252523248822316633339393821052614033884661649376604245744651142959498917235138077366818109892738298251161767344501687113868331134288984466294415889635863660753717476594011236542159800099371872396181448655448842148998667568104710807411358117939831241620315

n2=21660190931013270559487983141966347279666044468572000325628282578595119101840917794617733535995976710097702806131277006786522442555607842485975616689297559583352413160087163656851019769465637856967511819803473940154712516380580146620018921406354668604523723340895843009899397618067679200188650754096242296166060735958270930743173912010852467114047301529983496669250671342730804149428700280401481421735184899965468191802844285699985370238528163505674350380528600143880619512293622576854525700785474101747293316814980311297382429844950643977825771268757304088259531258222093667847468898823367251824316888563269155865061  
e2=70001  
c2=8180690717251057689732022736872836938270075717486355807317876695012318283159440935866297644561407238807004565510263413544530421072353735781284166685919420305808123063907272925594909852212249704923889776430284878600408776341129645414000647100303326242514023325498519509077311907161849407990649396330146146728447312754091670139159346316264091798623764434932753276554781692238428057951593104821823029665203821775755835076337570281155689527215367647821372680421305939449511621244288104229290161484649056505784641486376741409443450331991557221540050574024894427139331416236263783977068315294198184169154352536388685040531

## 题解

看到 n, e, c，数字还这么大，第一眼就是 RSA。但是这里要分解 n 来求 phi(n)，有点恶心。

自己不不想写大质数分解了（也不会），直接找网上的工具吧

https://github.com/Ganapati/RsaCtfTool

用 `$ ./RsaCtfTool.py -n 0000 -e 0000 -uncipher xxxx` 即可

好吧，我错了。

没发现这个 n 已经有 600 位了，没发现两个 n 是一样的，没发现 e1 和 e2 互质。

我是傻逼。

然后就可以共模攻击了，原理很简单，我就不介绍了，详细推导见

[rsa大礼包（三）低解密指数攻击、共模攻击、低解](https://code.felinae98.cn/ctf/crypto/rsa%e5%a4%a7%e7%a4%bc%e5%8c%85%ef%bc%88%e4%b8%89%ef%bc%89%e4%bd%8e%e8%a7%a3%e5%af%86%e6%8c%87%e6%95%b0%e6%94%bb%e5%87%bb%e3%80%81%e5%85%b1%e6%a8%a1%e6%94%bb%e5%87%bb%e3%80%81%e4%bd%8e%e8%a7%a3/)

好的 RSA 相关问题总结 [CTF中常见的RSA相关问题总结](https://xz.aliyun.com/t/2446)

简单两句话推导就是

e1 * s1 + e2 * s2 = 1

c1^s1 * c2^s2 % n = m^(e1 * s1 + e2 * s2) % n = m % n

```python
import sys
sys.setrecursionlimit(10000000)

def exgcd(a, b):
    if not b:
        return a, 1, 0
    d, y, x = exgcd(b, a % b)
    return d, x, y - a // b * x

def inv(a, p):
    d, x, y = exgcd(a, p)
    return (x + p) % p

def fpow(a, b, c):
    a = a % c
    r = 1
    if b < 0:
        a = inv(a, c)
        b = -b
    while b:
        if b & 1:
            r = r * a % c
        a = a * a % c
        b = b >> 1
    return r

n = int(input("n="))
e1 = int(input("e1="))
c1 = int(input("c1="))
e2 = int(input("e2="))
c2 = int(input("c2="))
_, s1, s2 = exgcd(e1, e2)

m = fpow(c1, s1, n) * fpow(c2, s2, n) % n

hx = bytes.fromhex(format(m, 'x'))
print(hx.decode('utf-8'))
```

## 答案

flag{gongmogongji}
